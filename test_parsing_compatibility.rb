#!/usr/bin/env ruby
require_relative 'config/environment'

# ìˆ˜ì •ëœ í”„ë¡¬í”„íŠ¸ í˜•ì‹ëŒ€ë¡œ ì‘ì„±ëœ í…ŒìŠ¤íŠ¸ í…ìŠ¤íŠ¸
test_analysis = <<~TEXT
## 1. ì²«ì¸ìƒ & ì „ì²´ì ì¸ ëŠë‚Œ

ì§€ì• ë‹˜, ì•ˆë…•í•˜ì„¸ìš”. ì¹´ì¹´ì˜¤ì—”í„° ë§ˆì¼€íŒ… ì§ë¬´ì— ì§€ì›í•˜ì‹  ìì†Œì„œë¥¼ ì½ì–´ë³´ë‹ˆ ì—´ì •ì´ ëŠê»´ì§‘ë‹ˆë‹¤.

## 2. ì˜ ì“´ ë¶€ë¶„ (Top 5 ê°•ì )

### ê°•ì  1: **êµ¬ì²´ì  ìˆ˜ì¹˜ ì œì‹œ**

ì§€ì›ìë‹˜ì˜ ìì†Œì„œì—ì„œ "30ë²ˆì˜ ëŒ€ì™¸í™œë™ê³¼ 5ë…„ê°„ì˜ ì•„ë¥´ë°”ì´íŠ¸"ë¼ëŠ” ë¶€ë¶„ì´ ë§¤ìš° ì¸ìƒì ì´ì—ˆìŠµë‹ˆë‹¤. ì´ëŸ° êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ëŠ” ì‹ ë¢°ê°ì„ ì¤ë‹ˆë‹¤.

HR í˜„ì¥ì—ì„œ ì´ëŸ° ì—­ëŸ‰ì´ ì™œ ì¤‘ìš”í•œì§€ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ìˆ«ìë¡œ í‘œí˜„ëœ ê²½í—˜ì€ í‰ê°€í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.

ë” ì¸ìƒì ì¸ ì ì€ ë‹¨ìˆœíˆ ìˆ«ìë§Œ ë‚˜ì—´í•œ ê²ƒì´ ì•„ë‹ˆë¼ëŠ” ì ì…ë‹ˆë‹¤. ê° ê²½í—˜ì˜ ì˜ë¯¸ë¥¼ ì˜ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.

### ê°•ì  2: **ê³ ê° ì¤‘ì‹¬ ì‚¬ê³ **

ê³ ê° ê´€ì ì—ì„œ ìƒê°í•˜ëŠ” ëŠ¥ë ¥ì´ ë‹ë³´ì…ë‹ˆë‹¤.

ì‹¤ì œ ì‚¬ë¡€ë¥¼ í†µí•´ ì´ë¥¼ ì¦ëª…í–ˆìŠµë‹ˆë‹¤.

ì´ëŸ° ì‚¬ê³ ë°©ì‹ì€ ë§ˆì¼€íŒ…ì—ì„œ í•µì‹¬ì…ë‹ˆë‹¤.

## 3. ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„ (Top 5 ê°œì„ ì )

### ê°œì„ ì  1: **ë¬¸ì¥ êµ¬ì¡° ê°œì„  í•„ìš”**

ì§€ì›ìë‹˜ì˜ ìì†Œì„œë¥¼ ì½ë‹¤ê°€ ì¼ë¶€ ë¬¸ì¥ì´ ë„ˆë¬´ ê¸¸ë‹¤ëŠ” ì ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ê°€ë…ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.

ì´ê²Œ ì™œ ì¤‘ìš”í•œì§€ ì‹¤ì œ ì‚¬ë¡€ë¡œ ì„¤ëª…ë“œë¦´ê²Œìš”. HR ë‹´ë‹¹ìë“¤ì€ ìˆ˜ë°± ê°œì˜ ìì†Œì„œë¥¼ ë¹ ë¥´ê²Œ ì½ì–´ì•¼ í•©ë‹ˆë‹¤.

ì´ ë¶€ë¶„ì„ ì´ë ‡ê²Œ ê°œì„ í•´ë³´ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. í•œ ë¬¸ì¥ì— í•˜ë‚˜ì˜ ë©”ì‹œì§€ë§Œ ë‹´ìœ¼ì„¸ìš”.

### ê°œì„ ì  2: **ì„±ê³¼ êµ¬ì²´í™” í•„ìš”**

í™œë™ì€ ë§ì´ í–ˆì§€ë§Œ êµ¬ì²´ì  ì„±ê³¼ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.

ì •ëŸ‰ì  ì§€í‘œë¥¼ ì¶”ê°€í•˜ë©´ ì„¤ë“ë ¥ì´ ë†’ì•„ì§‘ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ "ë§¤ì¶œ 00% ì¦ê°€" ê°™ì€ í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”.

## 4. ìˆ¨ê²¨ì§„ ë³´ì„ ì°¾ê¸° (3ê°œ)

### ë³´ì„ 1: **ë°ì´í„° ë¶„ì„ ì—­ëŸ‰**

ì§€ì›ìë‹˜ì˜ ìì†Œì„œë¥¼ ë‹¤ì‹œ ì½ë‹¤ê°€ ìˆ¨ê²¨ì§„ ë°ì´í„° ë¶„ì„ ëŠ¥ë ¥ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ í° ì ì¬ë ¥ì´ ìˆìŠµë‹ˆë‹¤.

ì´ ë¶€ë¶„ì´ ì™œ ì¤‘ìš”í•œì§€ ì—…ê³„ íŠ¸ë Œë“œì™€ ì—°ê²°í•´ì„œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë§ˆì¼€íŒ…ì—ì„œ ë°ì´í„°ëŠ” í•µì‹¬ì…ë‹ˆë‹¤.

ì´ ì—­ëŸ‰ì„ ì´ë ‡ê²Œ í™œìš©í•˜ë©´ ë”ìš± ê°•ë ¥í•œ ìì†Œì„œê°€ ë  ê²ƒì…ë‹ˆë‹¤. êµ¬ì²´ì  íˆ´ ê²½í—˜ì„ ì¶”ê°€í•˜ì„¸ìš”.

### ë³´ì„ 2: **í¬ë¡œìŠ¤ ì±„ë„ ê²½í—˜**

ì˜¨ì˜¤í”„ë¼ì¸ì„ ë„˜ë‚˜ë“œëŠ” ê²½í—˜ì´ ìˆ¨ì–´ìˆìŠµë‹ˆë‹¤.

ì´ëŠ” ì˜´ë‹ˆì±„ë„ ì‹œëŒ€ì— í° ìì‚°ì…ë‹ˆë‹¤.

ë” ë¶€ê°ì‹œì¼œë³´ì„¸ìš”.

## 5. ë§ˆì§€ë§‰ ê²©ë ¤ì™€ ì‘ì›

ì§€ì• ë‹˜, ì¶©ë¶„í•œ ì ì¬ë ¥ì„ ê°€ì§€ê³  ê³„ì‹­ë‹ˆë‹¤. í™”ì´íŒ…!
TEXT

puts "=" * 80
puts "íŒŒì‹± í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸"
puts "=" * 80

service = AdvancedCoverLetterService.new
parsed = service.parse_analysis_to_json(test_analysis)

if parsed
  puts "\nâœ… íŒŒì‹± ì„±ê³µ!"
  puts "\nì„¹ì…˜ ê°œìˆ˜: #{parsed['sections'].length}"
  
  parsed['sections'].each do |section|
    puts "\nğŸ“Œ ì„¹ì…˜ #{section['number']}: #{section['title']}"
    puts "   - content ê¸¸ì´: #{section['content'].length}"
    puts "   - items ê°œìˆ˜: #{section['items'].length}"
    
    if section['items'].any?
      section['items'].each do |item|
        puts "     â€¢ #{item['type']} #{item['number']}: #{item['title']}"
        
        # íŒŒì‹±ì´ ì œëŒ€ë¡œ ë˜ì—ˆëŠ”ì§€ í™•ì¸
        if item['content'].empty?
          puts "       âš ï¸ ë‚´ìš©ì´ ë¹„ì–´ìˆìŒ!"
        else
          puts "       âœ… ë‚´ìš© ìˆìŒ (#{item['content'].length}ì)"
        end
      end
    end
  end
  
  # íŒŒì‹± ë¬¸ì œ ì²´í¬
  puts "\nğŸ” íŒŒì‹± ë¬¸ì œ ì²´í¬:"
  
  # ê°•ì  ì„¹ì…˜ ì²´í¬
  strengths_section = parsed['sections'].find { |s| s['number'] == '2' }
  if strengths_section
    if strengths_section['items'].length == 2
      puts "âœ… ê°•ì  í•­ëª© 2ê°œ ì •ìƒ íŒŒì‹±"
    else
      puts "âš ï¸ ê°•ì  í•­ëª© ê°œìˆ˜: #{strengths_section['items'].length} (ì˜ˆìƒ: 2)"
    end
  end
  
  # ê°œì„ ì  ì„¹ì…˜ ì²´í¬
  improvements_section = parsed['sections'].find { |s| s['number'] == '3' }
  if improvements_section
    if improvements_section['items'].length == 2
      puts "âœ… ê°œì„ ì  í•­ëª© 2ê°œ ì •ìƒ íŒŒì‹±"
    else
      puts "âš ï¸ ê°œì„ ì  í•­ëª© ê°œìˆ˜: #{improvements_section['items'].length} (ì˜ˆìƒ: 2)"
    end
  end
  
  # ë³´ì„ ì„¹ì…˜ ì²´í¬
  gems_section = parsed['sections'].find { |s| s['number'] == '4' }
  if gems_section
    if gems_section['items'].length == 2
      puts "âœ… ë³´ì„ í•­ëª© 2ê°œ ì •ìƒ íŒŒì‹±"
    else
      puts "âš ï¸ ë³´ì„ í•­ëª© ê°œìˆ˜: #{gems_section['items'].length} (ì˜ˆìƒ: 2)"
    end
  end
  
else
  puts "âŒ íŒŒì‹± ì‹¤íŒ¨!"
end