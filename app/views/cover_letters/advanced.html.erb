<div class="min-h-screen bg-gradient-to-br from-gray-50 to-white py-12">
  <div class="max-w-4xl mx-auto px-4">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">
        🎯 3단계 AI 심층 분석
      </h1>
      <p class="text-lg text-gray-600">
        기업 분석 → 자소서 평가 → 맞춤형 자소서 생성까지
      </p>
      <div class="flex justify-center items-center mt-6 space-x-8">
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
          <span class="ml-2 text-sm font-medium">기업 분석</span>
        </div>
        <div class="h-px w-12 bg-gray-300"></div>
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
          <span class="ml-2 text-sm font-medium">자소서 평가</span>
        </div>
        <div class="h-px w-12 bg-gray-300"></div>
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">3</div>
          <span class="ml-2 text-sm font-medium">맞춤 생성</span>
        </div>
      </div>
    </div>

    <!-- Form -->
    <%= form_with(model: @cover_letter, url: analyze_advanced_cover_letters_path, local: true, class: "bg-white shadow-xl rounded-2xl p-8") do |form| %>
      <% if @cover_letter.errors.any? %>
        <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <p class="text-red-800 font-semibold mb-2">다음 오류를 확인해주세요:</p>
          <ul class="list-disc list-inside text-red-700">
            <% @cover_letter.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- Features -->
      <div class="mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl">
        <h3 class="font-bold text-gray-900 mb-4">✨ 3단계 심층 분석의 특별함</h3>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="flex items-start">
            <span class="text-2xl mr-3">🏢</span>
            <div>
              <p class="font-semibold text-gray-800">기업 분석</p>
              <p class="text-sm text-gray-600">최신 현안과 인재상 파악</p>
            </div>
          </div>
          <div class="flex items-start">
            <span class="text-2xl mr-3">📊</span>
            <div>
              <p class="font-semibold text-gray-800">15년 경력 평가</p>
              <p class="text-sm text-gray-600">인사팀 선배의 디테일한 조언</p>
            </div>
          </div>
          <div class="flex items-start">
            <span class="text-2xl mr-3">✍️</span>
            <div>
              <p class="font-semibold text-gray-800">맞춤형 생성</p>
              <p class="text-sm text-gray-600">기업별 최적화된 자소서</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Basic Information -->
      <div class="space-y-6">
        <div>
          <%= form.label :user_name, "이름", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_field :user_name, 
              placeholder: "홍길동",
              class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <%= form.label :company_name, "지원 기업", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :company_name, 
                placeholder: "삼성전자",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
          </div>

          <div>
            <%= form.label :position, "지원 직무", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :position, 
                placeholder: "소프트웨어 개발",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
          </div>
        </div>

        <div>
          <%= form.label :title, "제목", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_field :title, 
              placeholder: "2025 상반기 신입 자기소개서",
              class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
        </div>

        <div>
          <%= form.label :content, "자기소개서 내용", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <div class="relative">
            <%= form.text_area :content, 
                rows: 15,
                placeholder: "자기소개서 내용을 입력해주세요.\n\n예시:\n저는 대학에서 컴퓨터공학을 전공하며...",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" %>
            <div class="absolute bottom-4 right-4 text-sm text-gray-400">
              <span id="char-count">0</span> / 5000자
            </div>
          </div>
        </div>
      </div>

      <!-- Process Description -->
      <div class="mt-8 p-6 bg-gray-50 rounded-xl">
        <h4 class="font-bold text-gray-900 mb-3">📋 분석 프로세스</h4>
        <ol class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start">
            <span class="font-semibold mr-2">1단계:</span>
            <span>기업의 핵심 사업, 최근 현안, 인재상을 분석합니다</span>
          </li>
          <li class="flex items-start">
            <span class="font-semibold mr-2">2단계:</span>
            <span>15년 경력 인사팀 선배의 관점으로 자소서를 평가합니다</span>
          </li>
          <li class="flex items-start">
            <span class="font-semibold mr-2">3단계:</span>
            <span>분석 결과를 바탕으로 맞춤형 자소서를 생성합니다</span>
          </li>
        </ol>
      </div>

      <!-- Submit Button -->
      <div class="mt-8 flex justify-center">
        <%= form.submit "🚀 3단계 심층 분석 시작", 
            class: "px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200 cursor-pointer shadow-lg" %>
      </div>
    <% end %>

    <!-- Links -->
    <div class="mt-8 text-center space-y-2">
      <p class="text-gray-600">다른 분석 방법을 원하시나요?</p>
      <div class="flex justify-center space-x-4">
        <%= link_to "📝 기본 분석", new_cover_letter_path, class: "text-blue-600 hover:text-blue-800" %>
        <%= link_to "💬 AI와 대화하며 작성", interactive_cover_letters_path, class: "text-blue-600 hover:text-blue-800" %>
      </div>
    </div>
  </div>
</div>

<script>
  // Character count
  document.addEventListener('turbo:load', () => {
    const textarea = document.querySelector('textarea[name="cover_letter[content]"]');
    const charCount = document.getElementById('char-count');
    
    if (textarea && charCount) {
      const updateCount = () => {
        charCount.textContent = textarea.value.length;
      };
      
      textarea.addEventListener('input', updateCount);
      updateCount();
    }
  });
</script>