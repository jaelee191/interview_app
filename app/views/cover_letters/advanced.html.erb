<div class="min-h-screen bg-gradient-to-br from-gray-50 to-white py-12">
  <div class="max-w-4xl mx-auto px-4">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">
        ğŸ¯ 3ë‹¨ê³„ AI ì‹¬ì¸µ ë¶„ì„
      </h1>
      <p class="text-lg text-gray-600">
        ê¸°ì—… ë¶„ì„ â†’ ìì†Œì„œ í‰ê°€ â†’ ë§ì¶¤í˜• ìì†Œì„œ ìƒì„±ê¹Œì§€
      </p>
      <div class="flex justify-center items-center mt-6 space-x-8">
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
          <span class="ml-2 text-sm font-medium">ê¸°ì—… ë¶„ì„</span>
        </div>
        <div class="h-px w-12 bg-gray-300"></div>
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
          <span class="ml-2 text-sm font-medium">ìì†Œì„œ í‰ê°€</span>
        </div>
        <div class="h-px w-12 bg-gray-300"></div>
        <div class="flex items-center">
          <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">3</div>
          <span class="ml-2 text-sm font-medium">ë§ì¶¤ ìƒì„±</span>
        </div>
      </div>
    </div>

    <!-- Form -->
    <%= form_with(model: @cover_letter, url: analyze_advanced_cover_letters_path, local: true, class: "bg-white shadow-xl rounded-2xl p-8") do |form| %>
      <% if @cover_letter.errors.any? %>
        <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <p class="text-red-800 font-semibold mb-2">ë‹¤ìŒ ì˜¤ë¥˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”:</p>
          <ul class="list-disc list-inside text-red-700">
            <% @cover_letter.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- PDF Upload Section -->
      <div class="mb-8 p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl">
        <h3 class="font-bold text-gray-900 mb-4">ğŸ“„ ì´ë ¥ì„œ/ìì†Œì„œ PDF ì—…ë¡œë“œ (ì„ íƒ)</h3>
        <div class="space-y-4">
          <div class="flex items-center justify-center w-full">
            <label for="pdf-upload" class="flex flex-col items-center justify-center w-full h-32 border-2 border-purple-300 border-dashed rounded-lg cursor-pointer bg-white hover:bg-purple-50 transition-colors">
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg class="w-8 h-8 mb-3 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <p class="mb-2 text-sm text-gray-700"><span class="font-semibold">í´ë¦­í•˜ì—¬ PDF ì—…ë¡œë“œ</span></p>
                <p class="text-xs text-gray-500">PDF íŒŒì¼ë§Œ ê°€ëŠ¥ (ìµœëŒ€ 10MB)</p>
              </div>
              <input id="pdf-upload" type="file" class="hidden" accept=".pdf" />
            </label>
          </div>
          <div id="pdf-info" class="hidden">
            <div class="bg-white p-4 rounded-lg border border-purple-200">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <svg class="w-6 h-6 text-purple-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9 2a2 2 0 00-2 2v8a2 2 0 002 2h6a2 2 0 002-2V6.414A2 2 0 0016.414 5L14 2.586A2 2 0 0012.586 2H9z"></path>
                  </svg>
                  <span id="pdf-filename" class="text-sm font-medium text-gray-700"></span>
                </div>
                <button id="remove-pdf" class="text-red-500 hover:text-red-700">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Features -->
      <div class="mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl">
        <h3 class="font-bold text-gray-900 mb-4">âœ¨ 3ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„ì˜ íŠ¹ë³„í•¨</h3>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="flex items-start">
            <span class="text-2xl mr-3">ğŸ¢</span>
            <div>
              <p class="font-semibold text-gray-800">ê¸°ì—… ë¶„ì„</p>
              <p class="text-sm text-gray-600">ìµœì‹  í˜„ì•ˆê³¼ ì¸ì¬ìƒ íŒŒì•…</p>
            </div>
          </div>
          <div class="flex items-start">
            <span class="text-2xl mr-3">ğŸ“Š</span>
            <div>
              <p class="font-semibold text-gray-800">15ë…„ ê²½ë ¥ í‰ê°€</p>
              <p class="text-sm text-gray-600">ì¸ì‚¬íŒ€ ì„ ë°°ì˜ ë””í…Œì¼í•œ ì¡°ì–¸</p>
            </div>
          </div>
          <div class="flex items-start">
            <span class="text-2xl mr-3">âœï¸</span>
            <div>
              <p class="font-semibold text-gray-800">ë§ì¶¤í˜• ìƒì„±</p>
              <p class="text-sm text-gray-600">ê¸°ì—…ë³„ ìµœì í™”ëœ ìì†Œì„œ</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Basic Information -->
      <div class="space-y-6">
        <div>
          <%= form.label :user_name, "ì´ë¦„", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_field :user_name, 
              placeholder: "í™ê¸¸ë™",
              class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <%= form.label :company_name, "ì§€ì› ê¸°ì—…", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :company_name, 
                placeholder: "ì‚¼ì„±ì „ì",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
          </div>

          <div>
            <%= form.label :position, "ì§€ì› ì§ë¬´", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :position, 
                placeholder: "ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
          </div>
        </div>

        <div>
          <%= form.label :title, "ì œëª©", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_field :title, 
              placeholder: "2025 ìƒë°˜ê¸° ì‹ ì… ìê¸°ì†Œê°œì„œ",
              class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
        </div>

        <div>
          <%= form.label :content, "ìê¸°ì†Œê°œì„œ ë‚´ìš©", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <div class="relative">
            <%= form.text_area :content, 
                rows: 15,
                placeholder: "ìê¸°ì†Œê°œì„œ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nì˜ˆì‹œ:\nì €ëŠ” ëŒ€í•™ì—ì„œ ì»´í“¨í„°ê³µí•™ì„ ì „ê³µí•˜ë©°...",
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" %>
            <div class="absolute bottom-4 right-4 text-sm text-gray-400">
              <span id="char-count">0</span> / 5000ì
            </div>
          </div>
        </div>
      </div>

      <!-- Process Description -->
      <div class="mt-8 p-6 bg-gray-50 rounded-xl">
        <h4 class="font-bold text-gray-900 mb-3">ğŸ“‹ ë¶„ì„ í”„ë¡œì„¸ìŠ¤</h4>
        <ol class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start">
            <span class="font-semibold mr-2">1ë‹¨ê³„:</span>
            <span>ê¸°ì—…ì˜ í•µì‹¬ ì‚¬ì—…, ìµœê·¼ í˜„ì•ˆ, ì¸ì¬ìƒì„ ë¶„ì„í•©ë‹ˆë‹¤</span>
          </li>
          <li class="flex items-start">
            <span class="font-semibold mr-2">2ë‹¨ê³„:</span>
            <span>15ë…„ ê²½ë ¥ ì¸ì‚¬íŒ€ ì„ ë°°ì˜ ê´€ì ìœ¼ë¡œ ìì†Œì„œë¥¼ í‰ê°€í•©ë‹ˆë‹¤</span>
          </li>
          <li class="flex items-start">
            <span class="font-semibold mr-2">3ë‹¨ê³„:</span>
            <span>ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë§ì¶¤í˜• ìì†Œì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤</span>
          </li>
        </ol>
      </div>

      <!-- Submit Button -->
      <div class="mt-8 flex justify-center">
        <%= form.submit "ğŸš€ 3ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„ ì‹œì‘", 
            class: "px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200 cursor-pointer shadow-lg" %>
      </div>
    <% end %>

    <!-- Links -->
    <div class="mt-8 text-center space-y-2">
      <p class="text-gray-600">ë‹¤ë¥¸ ë¶„ì„ ë°©ë²•ì„ ì›í•˜ì‹œë‚˜ìš”?</p>
      <div class="flex justify-center space-x-4">
        <%= link_to "ğŸ“ ê¸°ë³¸ ë¶„ì„", new_cover_letter_path, class: "text-blue-600 hover:text-blue-800" %>
        <%= link_to "ğŸ’¬ AIì™€ ëŒ€í™”í•˜ë©° ì‘ì„±", interactive_cover_letters_path, class: "text-blue-600 hover:text-blue-800" %>
      </div>
    </div>
  </div>
</div>

<script>
  // Character count and PDF upload
  document.addEventListener('turbo:load', () => {
    const textarea = document.querySelector('textarea[name="cover_letter[content]"]');
    const charCount = document.getElementById('char-count');
    
    if (textarea && charCount) {
      const updateCount = () => {
        charCount.textContent = textarea.value.length;
      };
      
      textarea.addEventListener('input', updateCount);
      updateCount();
    }
    
    // PDF Upload functionality
    const pdfUpload = document.getElementById('pdf-upload');
    const pdfInfo = document.getElementById('pdf-info');
    const pdfFilename = document.getElementById('pdf-filename');
    const removePdf = document.getElementById('remove-pdf');
    let selectedFile = null;
    
    if (pdfUpload) {
      pdfUpload.addEventListener('change', function(e) {
        const file = e.target.files[0];
        
        if (file) {
          // Validate file type
          if (file.type !== 'application/pdf') {
            alert('PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
            this.value = '';
            return;
          }
          
          // Validate file size (10MB)
          if (file.size > 10 * 1024 * 1024) {
            alert('íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
            this.value = '';
            return;
          }
          
          selectedFile = file;
          pdfFilename.textContent = file.name;
          pdfInfo.classList.remove('hidden');
          
          // Add hidden input for file
          const existingInput = document.getElementById('pdf-file-data');
          if (existingInput) {
            existingInput.remove();
          }
          
          // Create FormData for file upload
          const reader = new FileReader();
          reader.onload = function(e) {
            const hiddenInput = document.createElement('input');
            hiddenInput.type = 'hidden';
            hiddenInput.id = 'pdf-file-data';
            hiddenInput.name = 'cover_letter[pdf_content]';
            hiddenInput.value = e.target.result;
            document.querySelector('form').appendChild(hiddenInput);
          };
          reader.readAsDataURL(file);
        }
      });
    }
    
    if (removePdf) {
      removePdf.addEventListener('click', function(e) {
        e.preventDefault();
        selectedFile = null;
        pdfUpload.value = '';
        pdfInfo.classList.add('hidden');
        pdfFilename.textContent = '';
        
        // Remove hidden input
        const hiddenInput = document.getElementById('pdf-file-data');
        if (hiddenInput) {
          hiddenInput.remove();
        }
      });
    }
  });
</script>