# AI 모델 사용 가이드라인

## 현재 모델 설정 (2025년 8월 기준)

### 🤖 기본 모델
- **모델명**: GPT-4.1
- **환경변수**: `OPENAI_MODEL=gpt-4.1`
- **사용처**: 
  - 기업 분석 (기본/강화)
  - 채용공고 분석
  - 자소서 생성
  - 일반 AI 분석

### 🧠 온톨로지 전용 모델
- **모델명**: GPT-5
- **환경변수**: `ONTOLOGY_MODEL=gpt-5`
- **사용처**: 
  - 온톨로지 기반 심층 분석
  - 최고 정확도가 필요한 경우

## 기업 분석 시스템

### 📊 기본 분석 (Basic Analysis)
- **처리 시간**: 5-10초
- **사용 모델**: GPT-4.1
- **토큰 사용**: ~500 tokens
- **저장 여부**: ❌ (세션에만 임시 저장)
- **분석 내용**:
  - 산업 분야 및 주요 사업 (2-3문장)
  - 최근 주요 이슈 추정
  - 비즈니스 현황
  - 일반적인 채용 패턴
- **비용**: 무료
- **응답 형식**: JSON

### 🚀 강화 분석 (Enhanced Analysis)
- **처리 시간**: 30-60초
- **사용 모델**: GPT-4.1
- **토큰 사용**: ~10,000+ tokens
- **저장 여부**: ✅ (DB 저장, 7일 캐시)
- **분석 타입**: `job_seeker_focused`
- **분석 내용**:
  1. Executive Summary (1,500자)
  2. 기업 개요 (2,000자)
  3. 산업/시장 분석 (2,000자)
  4. 채용 전략 (1,500자+)
  5. 자소서/면접 준비 (2,000자)
  6. 경쟁사 비교 (1,500자)
  7. 컨설턴트 조언 (1,500자+)
- **최소 분량**: 3,500자 이상
- **비용**: 프리미엄 전용
- **특징**: 
  - 구직자 맞춤형 실용적 조언
  - 15년 경력 컨설턴트 관점
  - 뉴스 크롤링 + AI 분석 결합

## 서비스별 모델 사용

### JobSeekerCompanyAnalyzerService (v4.0 - 2025.08 업데이트)
```ruby
model: ENV['OPENAI_MODEL'] || 'gpt-4.1'
temperature: 0.7
max_tokens: 4000 (통합 분석)
response_format: { type: "json_object" }  # JSON 모드 사용
```

#### 새로운 통합 프롬프트 특징:
- **작성 원칙**: "왜 중요한가 → 취업 준비생에게 어떤 의미인가 → 어떻게 활용할 수 있는가"
- **필수 요소**: 데이터, 실제 채용공고 키워드, 최근 3년 내 기업 이슈
- **[취업 TIP]**: 각 섹션 끝 실질적 전략 정리
- **심층 분석**: 채용 전략 & 컨설턴트 조언 각 1,500자 이상
- **최종 분량**: 최소 3,500자 이상 전문 컨설팅 보고서

### CompanyContextAnalyzerService
```ruby
model: ENV['OPENAI_MODEL'] || 'gpt-4.1'
temperature: 0.3
response_format: { type: "json_object" }
```

### OntologyAnalysisService
```ruby
model: ENV['ONTOLOGY_MODEL'] || 'gpt-5'
temperature: 0.5
max_tokens: 3000+
```

## API 키 관리
- **Primary**: `OPENAI_API_KEY`
- **Parallel Processing**: 
  - `OPENAI_API_KEY_2`
  - `OPENAI_API_KEY_3`
  - `OPENAI_API_KEY_4`

## 모델 선택 기준

### GPT-4.1 사용 시
- 일반적인 분석 작업
- 비용 효율성이 중요한 경우
- 대부분의 사용자 요청

### GPT-5 사용 시
- 최고 수준의 정확도 필요
- 복잡한 온톨로지 분석
- 프리미엄 기능

## 프롬프트 엔지니어링 원칙
1. **역할 부여**: "당신은 15년 경력의 시니어 취업 컨설턴트입니다"
2. **구조화**: 명확한 섹션 구분과 형식 지정
3. **분량 지정**: 최소 글자 수 명시
4. **실용성**: "왜 중요한가 → 어떻게 준비하나 → 실제 활용법"
5. **일관성**: 동일한 분석 구조 유지

## 업데이트 방법
1. `.env` 파일에서 `OPENAI_MODEL` 값 변경
2. 서비스 파일의 기본값 확인 및 수정
3. Rails 서버 재시작

## 모니터링
- 토큰 사용량 추적
- API 응답 시간 측정
- 에러율 모니터링
- 사용자 만족도 체크

---
*최종 업데이트: 2025년 8월*
*작성자: JACHUI Development Team*